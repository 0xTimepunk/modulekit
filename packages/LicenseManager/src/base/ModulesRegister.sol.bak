// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

import "../DataTypes.sol";
import { Ownable } from "solady/auth/Ownable.sol";
import "../interfaces/IFeeMachine.sol";

abstract contract ModuleAdministration is Ownable {
    error UnauthorizedFeeMachine();

    event FeeMachineSet(IFeeMachine feeMachine, bool enabled);

    mapping(IFeeMachine feeMachine => bool enabled) internal $feeMachines;

    modifier onlyFeeMachine() {
        if (!$feeMachines[IFeeMachine(msg.sender)]) revert UnauthorizedFeeMachine();
        _;
    }

    function authorizeFeeMachine(IFeeMachine feeMachine, bool enabled) external onlyOwner {
        if (!feeMachine.supportsInterface(type(IFeeMachine).interfaceId)) {
            revert UnauthorizedFeeMachine();
        }
        $feeMachines[feeMachine] = enabled;
        emit FeeMachineSet(feeMachine, enabled);
    }
}
